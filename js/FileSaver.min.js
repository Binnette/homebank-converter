/* FileSaver.js
 *  A saveAs() FileSaver implementation.
 *  2014-05-27
 *
 *  By Eli Grey, http://eligrey.com
 *  License: X11/MIT
 *    See https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md
 */
var saveAs=saveAs||typeof navigator!=="undefined"&&navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob.bind(navigator)||function(e){"use strict";if(typeof navigator!=="undefined"&&/MSIE [1-9]\./.test(navigator.userAgent)){return}var t=e.document,n=function(){return e.URL||e.webkitURL||e},r=t.createElementNS("http://www.w3.org/1999/xhtml","a"),i=!e.externalHost&&"download"in r,s=function(n){var r=t.createEvent("MouseEvents");r.initMouseEvent("click",true,false,e,0,0,0,0,0,false,false,false,false,0,null);n.dispatchEvent(r)},o=e.webkitRequestFileSystem,u=e.requestFileSystem||o||e.mozRequestFileSystem,a=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},f="application/octet-stream",l=0,c=[],h=function(){var e=c.length;while(e--){var t=c[e];if(typeof t==="string"){n().revokeObjectURL(t)}else{t.remove()}}c.length=0},p=function(e,t,n){t=[].concat(t);var r=t.length;while(r--){var i=e["on"+t[r]];if(typeof i==="function"){try{i.call(e,n||e)}catch(s){a(s)}}}},d=function(t,a){var h=this,d=t.type,v=false,m,g,y=function(){var e=n().createObjectURL(t);c.push(e);return e},b=function(){p(h,"writestart progress write writeend".split(" "))},w=function(){if(v||!m){m=y(t)}if(g){g.location.href=m}else{window.open(m,"_blank")}h.readyState=h.DONE;b()},E=function(e){return function(){if(h.readyState!==h.DONE){return e.apply(this,arguments)}}},S={create:true,exclusive:false},x;h.readyState=h.INIT;if(!a){a="download"}if(i){m=y(t);r.href=m;r.download=a;s(r);h.readyState=h.DONE;b();return}if(e.chrome&&d&&d!==f){x=t.slice||t.webkitSlice;t=x.call(t,0,t.size,f);v=true}if(o&&a!=="download"){a+=".download"}if(d===f||o){g=e}if(!u){w();return}l+=t.size;u(e.TEMPORARY,l,E(function(e){e.root.getDirectory("saved",S,E(function(e){var n=function(){e.getFile(a,S,E(function(e){e.createWriter(E(function(n){n.onwriteend=function(t){g.location.href=e.toURL();c.push(e);h.readyState=h.DONE;p(h,"writeend",t)};n.onerror=function(){var e=n.error;if(e.code!==e.ABORT_ERR){w()}};"writestart progress write abort".split(" ").forEach(function(e){n["on"+e]=h["on"+e]});n.write(t);h.abort=function(){n.abort();h.readyState=h.DONE};h.readyState=h.WRITING}),w)}),w)};e.getFile(a,{create:false},E(function(e){e.remove();n()}),E(function(e){if(e.code===e.NOT_FOUND_ERR){n()}else{w()}}))}),w)}),w)},v=d.prototype,m=function(e,t){return new d(e,t)};v.abort=function(){var e=this;e.readyState=e.DONE;p(e,"abort")};v.readyState=v.INIT=0;v.WRITING=1;v.DONE=2;v.error=v.onwritestart=v.onprogress=v.onwrite=v.onabort=v.onerror=v.onwriteend=null;e.addEventListener("unload",h,false);m.unload=function(){h();e.removeEventListener("unload",h,false)};return m}(typeof self!=="undefined"&&self||typeof window!=="undefined"&&window||this.content);if(typeof module!=="undefined"&&module!==null){module.exports=saveAs}else if(typeof define!=="undefined"&&define!==null&&define.amd!=null){define([],function(){return saveAs})}